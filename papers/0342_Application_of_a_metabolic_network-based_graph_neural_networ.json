{
  "pmcid": "PMC12198668",
  "doi": "10.1093/toxsci/kfaf065",
  "title": "Application of a metabolic network-based graph neural network for the identification of toxicant-induced perturbations",
  "authors": [
    "Keji Yuan",
    "Rance Nault"
  ],
  "year": "2025",
  "journal": "Toxicological Sciences",
  "abstract": "AbstractTranscriptomic analyses have been an effective approach to investigate the biological responses and metabolic perturbations by environmental contaminants in rodent models. However, it is well recognized that metabolic networks are highly connected and complex, and that traditional gene expression analysis methods, including pathway analyses, have a limited ability to capture these complexities. Given that metabolism can be effectively represented as a graph, this study aims to apply a network-based graph neural network (GNN) to uncover novel or hidden metabolic perturbations in response to a toxicant. A GNN model based on the mouse Reactome pathways was trained and validated on 7,689 transcriptomic samples from 26 mouse tissues curated from Recount3. This model was then used to identify important reactions in publicly available data from livers of mice treated with the environmental contaminant 2,3,7,8-tetrachlorodibenzo-p-dioxin (TCDD) achieving a performance of 100% when comparing a single dose to a control group. Integrated gradients and centrality analyses identified perturbation of the SUMOylation, cell cycle, P53 signaling, and collagen biosynthesis pathways by TCDD which were not identified using a pathway analysis approach. Collectively, our results demonstrate that GNNs can reveal novel mechanistic insights into toxicant-mediated metabolic disruption, presenting a putative strategy to characterize biological responses to toxicant exposures.Our studies illustrate how the use of a reaction-based graph neural network can support the discovery of toxicant-induced metabolic perturbations, and highlight strengths and challenges in the application of artificial intelligence methods for environmental health research.",
  "sections": [
    {
      "title": "Materials and methods",
      "text": "In this study examining the metabolic perturbations of a toxicant in mouse models, we applied the GNN approach developed by Burkhart et al. (2023) replacing the human reaction network with the mouse reaction network from Reactome (https://reactome.org/; version 89). Reactome is a manually curated human metabolic reaction network with orthologous reactions mapped in several other species including mouse (Fabregat et al. 2018). In this manuscript, a reaction is defined as a single step in a pathway (e.g. glucose 6-phosphate to glucono-1,5-lactone 6 phosphate in the pentose phosphate pathway). A detailed description of how the reaction network was built is provided in Supplementary Methods and based on publicly available code (https://github.com/joshuaburkhart/reticula/tree/master). All mouse transcriptomic datasets used in these analyses were obtained from the Recount3 pipeline (Wilks et al. 2021), and downloaded using the Recount3 package in R (v4.3.1). Recount3 represents the third iteration of the Recount project which processes publicly available data from human and mouse, processed through a uniform pipeline facilitating their comparison (Wilks et al. 2021; Razi et al. 2024). Data aligned to gencode_v26 were downloaded and the metadata extracted from the sra.experiment_attributes column of the R object. The metadata were further parsed to extract experimental design metadata including age, strain, sex, and treatment (Table S1; https://doi.org/10.5061/dryad.k3j9kd5kz). Because of inconsistent use of field names and values, datasets had to be subsequently manually curated. To train the GNN, samples were filtered to include only data from wild-type (any strain) naïve or control (treated only with vehicle) postnatal mouse datasets. We also excluded single-cell transcriptomic datasets or those generated from in vitro assays. We also manually curated tissue labels to collapse similar tissues into a single term (e.g. jejunum, duodenum, ileum, and colon were collapsed into intestine) due to the small number of samples for each when used separately. The initial number of samples was 225,558 which was filtered to 7,903 samples representing 26 different tissues from 720 independent project (SRP) IDs (Table 1, Table S2; https://doi.org/10.5061/dryad.k3j9kd5kz). Summary of tissue sample counts for the training and validation of GNN and ResNet18 models. Test datasets to evaluate metabolic perturbations elicited by treatment with a toxicant were similarly obtained from Recount3. We used datasets from livers of mice treated with the environmental contaminant TCDD as one of the most highly represented treatment paradigms with 5 independent datasets. The study designs for the 5 datasets were as follows: (1) male mice treated with vehicle or 30 µg/kg TCDD for 2, 4, 8, 12, 24, and 72 h (Nault et al. 2018); (2) male mice treated every 4 days for 28 days with 0, 0.01, 0.03, 0.1, 0.3, 1, 3, 10, or 30 µg/kg TCDD (Fader et al. 2017); (3) female mice treated every 4 days for 92 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2016); (4) female mice treated every 4 days for 28 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2015); (5) male mice treated every 4 days with sesame oil vehicle or 30 µg/kg TCDD for 28 days and tissues collected at Zeitgeber (ZT) times ZT0, ZT3, ZT6, ZT9, ZT12, ZT15, ZT18, and ZT21 (Fader et al. 2019). The initial number of test samples was 383, however, samples from the time-course study were eventually excluded as it impeded the model performance given such a large difference in the study design which is described in the “Results” section. With the exclusion of those samples, the final number of test samples was 299 (Table 2). Sample counts for each TCDD dose group. The gene expression count data were filtered to retain only the genes linked to Reactome reactions and removing any genes which were not expressed. Variance stabilizing transformation was applied using DESeq2 (Love et al. 2014). For each reaction, associated genes were subset and principal component analysis (PCA) was applied. The first component was kept for use in the GNN model. K-Nearest Neighbors (KNNs) algorithm using a 10-fold cross-validation method was used to confirm that reaction PC1 values could accurately classify tissues by calculating the average misclassification rate and the Adjusted Rand Index (ARI). As described by Burkhart et al. (2023), we initially tested both a GNN and ResNet18, an 18-layer CNN designed specifically for image classification (He et al. 2015). ResNet18, a well-established and high-performing neural network model traditionally used for image classification, is a suitable candidate for this problem due to its ability to extract hierarchical features from complex patterns, which can be leveraged to analyze metabolic reaction networks by representing reactions as grid-like feature structures. The GNN architecture used was based on that developed by Burkhart et al. (2023) which comprised 3 GraphConv layers from PyTorch Geometric, each mapping features to 64 hidden units. ReLU activation functions were applied after the first 2 graph convolution layers to handle nonlinear relationships. Global mean pooling was employed as the readout layer to aggregate node features into graph-level representations. A final linear layer converts these features into the number of tissue classification labels. To mitigate overfitting, a default dropout rate of 0.5 was applied before the final classification layer. For model training and validation, we used the Adam optimizer with default learning rate of 0.001 and cross-entropy loss function. The batch size was set to 64 to balance memory usage and computational efficiency. Model weights were initialized using PyTorch’s default initialization. The training and validation were conducted for a maximum of 500 epochs based on Burkhart’s experimental method, without implementing early stopping, to ensure comparability of results. Learning curves were monitored to confirm model convergence within this epoch limit. Samples were randomly assigned to either training (80%) or validation (20%) resulting in 6,288 training samples and 1,445 validation samples (Table 1). We started by classifying the 26 tissue types to establish tissue-specific reaction network states as weights within the GNN using the training data. The randomly selected validation dataset was represented by 13 tissue types. A maximum of 500 epochs was adopted based on previous performance demonstrations. Performance between GNN and ResNet18 was compared using the ARI, Mathews correlation coefficient (MCC), F1 score, precision, recall, and operating characteristic area under the receiver operating characteristic curve (AUROC) implemented with the sklearn.metrics package in Python. To evaluate putative biases and possibility of overfitting, we also performed a stratified 10-fold validation as well as 10 times repeated random subsampling train-validation split. To adapt the original GNN model to the testing (toxicant) dataset, we modified the network structure, focusing particularly on the final fully connected layer. This modification was necessary to accommodate the specific feature dimensions and the number of output classes in the new dataset. Specifically, we utilized the pretrained GNN model and applied transfer learning to enable effective prediction on the testing dataset (Li et al. 2023a). The original output layer, designed for predicting 26 classes, was replaced with a linear layer that has a matching number of output channels as dose labels. Specifically, when using all dose groups from the test datasets a total of 9 output channels was used. Similarly, for the binary dose classification a total of 2 output channels were used reflecting the control and 30 µg/kg groups. This adjustment ensured that the output dimensions aligned properly with the classification task. Additionally, we employed a parameter-freezing strategy to retain the representational power of the pretrained model while allowing the new final layer to adapt to the new task. Known as “partial parameter freezing” in transfer learning, this approach allows the pretrained model to maintain its learned feature extraction capabilities while effectively learning from the new dataset (Shen et al. 2021). Specifically, we froze the parameters of the initial layers in the GNN architecture and only allowed the final layer (i.e. lin.weight and lin.bias) to be updated. This method not only speeds up the training process but also improves the generalizability of the model (Li et al. 2023a). To understand the contributions of individual edges (reaction to reaction connection) to the GNN’s classification performance, we employed integrated gradients (IG) as previously described to calculate the gradients of edge weights (Sundararajan et al. 2017; Burkhart et al. 2023). IG is an attribution method that quantifies the impact of each input feature on the model’s predictions. Specifically, we used IG to compute the gradients with respect to the edge weights, serving as indicators of edge importance within the graph structure. IG gradients were sorted from highest to lowest and considered either the top 1% IG values or the top 100 IG values as the most important for subsequent analyses. To determine whether the same results were discoverable with varying sample sizes, we split our dataset into randomly selected 10% to 100% subsets. We computed eigenvector and closeness centrality measures for both criteria methods for top reactions (Table S3). Eigenvector centrality measures the influence of a node in a network by considering not only the number of direct connections it has but also the influence of those connected nodes. This allows us to identify responses that may have a small number of neighbors, but those neighbors are highly connected. Closeness centrality, on the other hand, focuses on the average shortest path between a node and all other nodes in the graph. This method helps identifying reactions that could easily affect or be affected by changes in other parts of the network. Differential gene expression analysis was performed using DESeq2 on the data prior to removing genes not represented in the mouse reaction network. Genes were considered differentially expressed when |log2(fold-change)|≥1.5 and P-adjusted value ≤0.05. Functional enrichment analysis of differentially expressed genes was used to compare the top identified reactions from the GNN analysis. Gene sets were generated from the same Reactome reactions used for the GNN, and enrichment analysis performed using the bc3net package in R. The enrichment was adjusted for multiple comparisons using the false discovery rate (FDR) method and reactions considered enriched when FDR≤0.05. All datasets used in this study were obtained from public repositories Recount3 and GEO. Accession IDs are provided in Tables S1 and S2 (https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN was generated as previously described using published analysis code (https://github.com/joshuaburkhart/reticula/tree/master) with modifications for use of mouse datasets and toxicogenomic data (https://github.com/jyb4444/Reticula_GNN; https://doi.org/10.5281/zenodo.15264946)."
    },
    {
      "title": "Creation of mouse metabolic reaction network",
      "text": "In this study examining the metabolic perturbations of a toxicant in mouse models, we applied the GNN approach developed by Burkhart et al. (2023) replacing the human reaction network with the mouse reaction network from Reactome (https://reactome.org/; version 89). Reactome is a manually curated human metabolic reaction network with orthologous reactions mapped in several other species including mouse (Fabregat et al. 2018). In this manuscript, a reaction is defined as a single step in a pathway (e.g. glucose 6-phosphate to glucono-1,5-lactone 6 phosphate in the pentose phosphate pathway). A detailed description of how the reaction network was built is provided in Supplementary Methods and based on publicly available code (https://github.com/joshuaburkhart/reticula/tree/master)."
    },
    {
      "title": "Description of training, validation, and test datasets",
      "text": "All mouse transcriptomic datasets used in these analyses were obtained from the Recount3 pipeline (Wilks et al. 2021), and downloaded using the Recount3 package in R (v4.3.1). Recount3 represents the third iteration of the Recount project which processes publicly available data from human and mouse, processed through a uniform pipeline facilitating their comparison (Wilks et al. 2021; Razi et al. 2024). Data aligned to gencode_v26 were downloaded and the metadata extracted from the sra.experiment_attributes column of the R object. The metadata were further parsed to extract experimental design metadata including age, strain, sex, and treatment (Table S1; https://doi.org/10.5061/dryad.k3j9kd5kz). Because of inconsistent use of field names and values, datasets had to be subsequently manually curated. To train the GNN, samples were filtered to include only data from wild-type (any strain) naïve or control (treated only with vehicle) postnatal mouse datasets. We also excluded single-cell transcriptomic datasets or those generated from in vitro assays. We also manually curated tissue labels to collapse similar tissues into a single term (e.g. jejunum, duodenum, ileum, and colon were collapsed into intestine) due to the small number of samples for each when used separately. The initial number of samples was 225,558 which was filtered to 7,903 samples representing 26 different tissues from 720 independent project (SRP) IDs (Table 1, Table S2; https://doi.org/10.5061/dryad.k3j9kd5kz). Summary of tissue sample counts for the training and validation of GNN and ResNet18 models. Test datasets to evaluate metabolic perturbations elicited by treatment with a toxicant were similarly obtained from Recount3. We used datasets from livers of mice treated with the environmental contaminant TCDD as one of the most highly represented treatment paradigms with 5 independent datasets. The study designs for the 5 datasets were as follows: (1) male mice treated with vehicle or 30 µg/kg TCDD for 2, 4, 8, 12, 24, and 72 h (Nault et al. 2018); (2) male mice treated every 4 days for 28 days with 0, 0.01, 0.03, 0.1, 0.3, 1, 3, 10, or 30 µg/kg TCDD (Fader et al. 2017); (3) female mice treated every 4 days for 92 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2016); (4) female mice treated every 4 days for 28 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2015); (5) male mice treated every 4 days with sesame oil vehicle or 30 µg/kg TCDD for 28 days and tissues collected at Zeitgeber (ZT) times ZT0, ZT3, ZT6, ZT9, ZT12, ZT15, ZT18, and ZT21 (Fader et al. 2019). The initial number of test samples was 383, however, samples from the time-course study were eventually excluded as it impeded the model performance given such a large difference in the study design which is described in the “Results” section. With the exclusion of those samples, the final number of test samples was 299 (Table 2). Sample counts for each TCDD dose group."
    },
    {
      "title": "Transcriptomic data preprocessing",
      "text": "The gene expression count data were filtered to retain only the genes linked to Reactome reactions and removing any genes which were not expressed. Variance stabilizing transformation was applied using DESeq2 (Love et al. 2014). For each reaction, associated genes were subset and principal component analysis (PCA) was applied. The first component was kept for use in the GNN model. K-Nearest Neighbors (KNNs) algorithm using a 10-fold cross-validation method was used to confirm that reaction PC1 values could accurately classify tissues by calculating the average misclassification rate and the Adjusted Rand Index (ARI)."
    },
    {
      "title": "Model setup description",
      "text": "As described by Burkhart et al. (2023), we initially tested both a GNN and ResNet18, an 18-layer CNN designed specifically for image classification (He et al. 2015). ResNet18, a well-established and high-performing neural network model traditionally used for image classification, is a suitable candidate for this problem due to its ability to extract hierarchical features from complex patterns, which can be leveraged to analyze metabolic reaction networks by representing reactions as grid-like feature structures. The GNN architecture used was based on that developed by Burkhart et al. (2023) which comprised 3 GraphConv layers from PyTorch Geometric, each mapping features to 64 hidden units. ReLU activation functions were applied after the first 2 graph convolution layers to handle nonlinear relationships. Global mean pooling was employed as the readout layer to aggregate node features into graph-level representations. A final linear layer converts these features into the number of tissue classification labels. To mitigate overfitting, a default dropout rate of 0.5 was applied before the final classification layer. For model training and validation, we used the Adam optimizer with default learning rate of 0.001 and cross-entropy loss function. The batch size was set to 64 to balance memory usage and computational efficiency. Model weights were initialized using PyTorch’s default initialization. The training and validation were conducted for a maximum of 500 epochs based on Burkhart’s experimental method, without implementing early stopping, to ensure comparability of results. Learning curves were monitored to confirm model convergence within this epoch limit."
    },
    {
      "title": "Training and validation of GNN",
      "text": "Samples were randomly assigned to either training (80%) or validation (20%) resulting in 6,288 training samples and 1,445 validation samples (Table 1). We started by classifying the 26 tissue types to establish tissue-specific reaction network states as weights within the GNN using the training data. The randomly selected validation dataset was represented by 13 tissue types. A maximum of 500 epochs was adopted based on previous performance demonstrations. Performance between GNN and ResNet18 was compared using the ARI, Mathews correlation coefficient (MCC), F1 score, precision, recall, and operating characteristic area under the receiver operating characteristic curve (AUROC) implemented with the sklearn.metrics package in Python. To evaluate putative biases and possibility of overfitting, we also performed a stratified 10-fold validation as well as 10 times repeated random subsampling train-validation split."
    },
    {
      "title": "Application of GNN for investigating toxicant-induced changes",
      "text": "To adapt the original GNN model to the testing (toxicant) dataset, we modified the network structure, focusing particularly on the final fully connected layer. This modification was necessary to accommodate the specific feature dimensions and the number of output classes in the new dataset. Specifically, we utilized the pretrained GNN model and applied transfer learning to enable effective prediction on the testing dataset (Li et al. 2023a). The original output layer, designed for predicting 26 classes, was replaced with a linear layer that has a matching number of output channels as dose labels. Specifically, when using all dose groups from the test datasets a total of 9 output channels was used. Similarly, for the binary dose classification a total of 2 output channels were used reflecting the control and 30 µg/kg groups. This adjustment ensured that the output dimensions aligned properly with the classification task. Additionally, we employed a parameter-freezing strategy to retain the representational power of the pretrained model while allowing the new final layer to adapt to the new task. Known as “partial parameter freezing” in transfer learning, this approach allows the pretrained model to maintain its learned feature extraction capabilities while effectively learning from the new dataset (Shen et al. 2021). Specifically, we froze the parameters of the initial layers in the GNN architecture and only allowed the final layer (i.e. lin.weight and lin.bias) to be updated. This method not only speeds up the training process but also improves the generalizability of the model (Li et al. 2023a)."
    },
    {
      "title": "Estimating edge importance attribution using integrated gradients",
      "text": "To understand the contributions of individual edges (reaction to reaction connection) to the GNN’s classification performance, we employed integrated gradients (IG) as previously described to calculate the gradients of edge weights (Sundararajan et al. 2017; Burkhart et al. 2023). IG is an attribution method that quantifies the impact of each input feature on the model’s predictions. Specifically, we used IG to compute the gradients with respect to the edge weights, serving as indicators of edge importance within the graph structure."
    },
    {
      "title": "Centrality-based network analysis of reactions",
      "text": "IG gradients were sorted from highest to lowest and considered either the top 1% IG values or the top 100 IG values as the most important for subsequent analyses. To determine whether the same results were discoverable with varying sample sizes, we split our dataset into randomly selected 10% to 100% subsets. We computed eigenvector and closeness centrality measures for both criteria methods for top reactions (Table S3). Eigenvector centrality measures the influence of a node in a network by considering not only the number of direct connections it has but also the influence of those connected nodes. This allows us to identify responses that may have a small number of neighbors, but those neighbors are highly connected. Closeness centrality, on the other hand, focuses on the average shortest path between a node and all other nodes in the graph. This method helps identifying reactions that could easily affect or be affected by changes in other parts of the network."
    },
    {
      "title": "Traditional differential gene expression analysis and functional enrichment analysis",
      "text": "Differential gene expression analysis was performed using DESeq2 on the data prior to removing genes not represented in the mouse reaction network. Genes were considered differentially expressed when |log2(fold-change)|≥1.5 and P-adjusted value ≤0.05. Functional enrichment analysis of differentially expressed genes was used to compare the top identified reactions from the GNN analysis. Gene sets were generated from the same Reactome reactions used for the GNN, and enrichment analysis performed using the bc3net package in R. The enrichment was adjusted for multiple comparisons using the false discovery rate (FDR) method and reactions considered enriched when FDR≤0.05."
    },
    {
      "title": "Data and code availability",
      "text": "All datasets used in this study were obtained from public repositories Recount3 and GEO. Accession IDs are provided in Tables S1 and S2 (https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN was generated as previously described using published analysis code (https://github.com/joshuaburkhart/reticula/tree/master) with modifications for use of mouse datasets and toxicogenomic data (https://github.com/jyb4444/Reticula_GNN; https://doi.org/10.5281/zenodo.15264946)."
    },
    {
      "title": "Results",
      "text": "Dimensionality reduction using PCA was used to reduce the complexity of the dataset and visualize the main sources of variance across the samples, allowing for easier interpretation and identification of key patterns or clusters within the data. The proportion of variance explained by the first 10 principal components for all reactions shows that the first principal component captures a median 52% of the variance with the 25th and 75th percentiles spanning 33% to 88% (Fig. 1A). PC2 explained a median 24% of the variance with each subsequent principal component explaining less of the variance. This is consistent with reported TCGA reaction-wise principal components (Burkhart et al. 2023). Given that the first component captured most of the sample variance, PC1 was used for subsequent analyses. Training and validation of a reaction-based GNN on bulk RNA sequencing datasets from disparate mouse tissues. (A) Distribution of reaction-wise principal component score distribution for the first 10 components. A total of 9,844 reactions are shown and the box represents the median, 25th, and 75th percentiles. (B) Reaction-wise ARIs for each tissue were calculated following clustering using a KNN algorithm. Bars represent the average of the top 10 ARIs for each tissue. (C) Training performance at each epoch for GNN and ResNet18 models, as well as control datasets, using reaction-wise PC1 values. The final accuracy is shown in the figure legend. ROC curves are shown for validation datasets using the (D) GNN and (E) ResNet18 models. AUROCs are indicated next to sample labels for each tissue type. Additional performance metrics are in Table S4. A KNNs’ analysis of reaction-wise PC1 with 10-fold cross-validation further confirms that it is suitable to distinguish samples from individual tissues (Fig. 1B). Notably, the average ARI for the top 10 reactions of both the training and validation sets exceeds 80%, indicating excellent true positive classification using PC1 values. Further examination of the identity of the reactions with the highest ARI in each tissue finds reactions known to be representative of the tissue such as reactions related to the endoplasmic reticulum and Golgi transport in the liver, myosin and calcium in the heart, and keratin in the skin (File S1). Following the training of the GNN and ResNet18 models, final accuracies at 500 epochs were 94% and 99%, respectively. Validation using the remaining 20% subset completed with accuracies of 93% and 99% for GNN and ResNet18, respectively (Fig. 1C). The high training accuracies demonstrate that both models effectively learned from the training data, whereas the similarly high validation accuracies suggest that the models generalize well to unseen data, indicating strong performance in classifying tissue types without overfitting. To ensure the lower limit of our training performance and evaluate whether GNN can capture the complex biological network, we apply 4 control datasets into GNN. A “Rewired Network” with randomly reconnected edges changes the network structure, demonstrating the importance of specific edge connections. A “Shuffled Features” randomizes the reaction-wise PC1 values, removing biological context to assess the contribution of these specific features. A “Shuffled Targets” set randomly assigns tissue labels, testing the importance of correct tissue labels for classification accuracy. A “Summation Dataset” sums the expression counts for a reaction instead of using a PC1 value to evaluate whether simpler features can provide comparable performance. As expected, both the GNN and ResNet18 models outperformed in classification accuracy compared with all control datasets (Fig. 1C). As Burkhart et al. (2023) demonstrated, ResNet18 performed better on the training data, however, in this study, there was no clear evidence that it may be overfitting on the training data. Further examination of the classification performance shows an AUROC≥0.84 for all tissues using the GNN model (Fig. 1D, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). ResNet18 showed a larger distribution in AUROC values performing more poorly for pancreas and skin samples and improved classification for muscle, main olfactory epithelium (MOE), intestine, and heart (Fig. 1E, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). However, ResNet18 appeared to generally perform better than the GNN in performance metrics (Table S5, Fig. S1A; https://doi.org/10.5061/dryad.k3j9kd5kz). To investigate potential bias or overfitting, we additionally performed a stratified 10-fold validation and 10 times repeated random subsampling validation (Fig. S3, File S3; https://doi.org/10.5061/dryad.k3j9kd5kz). Although the final model performance was generally good (>0.8), it was generally poorer in the stratified k-fold validation compared with random subsampling (Fig. S3). Anticipating that this may be due to the imbalanced tissue type representation, we examined the F1 score for each tissue following validation. A large amount of variation in classification performance was observed using both approaches with poorly represented tissues such as the mammary gland and thymus performing very poorly. Conversely, liver, which had the largest number of samples always performed well. Collectively, these analyses suggest better model performance for well-represented samples. Given that tissue types such as the liver represent more than 720 independently generated datasets, these 10-fold validations suggest that the model is not overfit for these tissues. Test liver samples represented by 4 independent studies were used to evaluate (i) binary dose classification (0 vs 30 µg/kg TCDD) or (ii) dose–response classification. Classification of binary dose groups consisted of 68 control and 68 treated samples, respectively. The dose–response analysis classification included 299 samples across 9 dose groups (0, 0.03, 0.01, 0.1, 0.3, 1, 3, 10, and 30 µg/kg). Initial analyses of test datasets completed after 500 epochs with an accuracy of 95% and 65% for the binary and dose–response datasets, respectively. The poor performance for the dose–response model suggested that the model performs poorly in conditions of gradual gene expression changes at intermediate doses which was confirmed when comparing to the ground truth (Fig. 2A). Testing performance for classification of TCDD test datasets by GNN model. Sample dose classification compared with ground truth from the GNN model (A) including or (B) excluding the time-course data (SRP131784). The point size represents the total number (log10 scale) of samples in each classification and true dose category. (C) Final accuracy at 500 epochs for the classification of the dose–response TCDD test dataset. Initial application of the GNN to the highest TCDD dose group compared with control revealed poor performance specifically for samples from the time-course dataset (SRA ID: SRP131784). This is likely due to the significant difference in exposure duration from acute (2 to 168 h) to subchronic (28 or 92 days). Therefore, SRP131784 was excluded from all subsequent analyses resulting in a final accuracy of 100% in the modeling of the binary dose dataset. Estimation of AUROC, F1 score, and MCC confirms perfect classification for binary comparison (Table S6; https://doi.org/10.5061/dryad.k3j9kd5kz). After exclusion of the time-course dataset, the dose–response classification accuracy increased to 76% (Table S7; https://doi.org/10.5061/dryad.k3j9kd5kz), and the target-prediction visualization displayed a more coherent trend extending from the left-bottom to the right-top corner (Fig. 2B). Although some noise persisted in the low doses (bottom-left), the clarity was notably enhanced. This observation suggests that when using small doses, the GNN model has difficulty capturing subtle transcriptomic changes, resulting in worse classification. To further evaluate the impact of dose-dependent changes, we performed independent pairwise comparisons for each dose group compared with control (e.g. 0.01 µg/kg TCDD vs control) resulting in a gradient in final accuracy that correlates to the increasing dose levels (Fig. 2C). Investigation of the top contributing reactions based on IG values in the binary classifications revealed variability despite the same reactions consistently ranking at the top (Table S8; https://doi.org/10.5061/dryad.k3j9kd5kz). Reactions associated with the largest IG values were often found to be located within small subnetworks which were not highly connected (Table 3, Fig. 3A, File S2). These represented reactions R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes) to R-MMU-8956140 (NEDD8 and UBD bind NUB1 and the 26S proteasome), part of the neddylation pathway, and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) involved in extracellular matrix remodeling. Visualization of key reaction nodes identified using IG values and centrality measurements. (A) Reactions identified as the highest IG values without centrality measurements found R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes”) to R-MMU-8956140 I (NEDD8 and UBD bind NUB1 and the 26S proteasome) and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) with IG values larger than 0.01. (B) Using closeness centrality analysis, key reactions found were R-MMU-6799246 (CHEK1 phosphorylates TP53) and R-MMU-5693609 (ATM phosphorylates TP53 at S15). (C) Eigenvector centrality found R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)). Top reactions (IG≥0.5) in the binary dose classification of TCDD. Given limited connectivity in the top edges, we applied network centrality measures to find highly connected reactions that drive treatment classification. Using Eigenvector and Closeness centrality, we found 3 key reactions: R-MMU-6799246 (CHEK1 phosphorylates TP53) was identified through closeness centrality, R-MMU-5693609 (ATM phosphorylates TP53 at S15) was identified through betweenness centrality (Fig. 3B, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz), and R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)) was identified through Eigenvector centrality (Fig. 3C, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz). These reactions are expected to play significant roles due to their influence within the network paired with high IG values (≥0.4). We used traditional differential gene expression and PA methods and compared results to those from our GNN model. When examining differential expression of genes associated with the most important reactions for classification of treatment groups, we find that our GNN identifies genes which would not have been identified using a traditional approach (Table 4). Genes Uba2, Sae1, and Rwdd2b in reaction R-MMU-2993780 were found to be statistically significant (P-adjusted ≤0.05), but did not meet the fold-change criteria. Similarly, genes in reactions R-MMU-5693609 and R-MMU-6799246, such as Trp53 and Chek1, showed significant upregulation, with Chek1 showing the most notable change (3.7-fold increase). Comparison of genes identified by traditional differential expression analysis and the reactions connected to top 1% IG values found only 205 genes in common representing ≤10% of genes (Fig. 4A). Collectively, this comparison points to the identification of distinct genes of interest. PA found 101 enriched reactions using a traditional method (Fisher’s exact test for overrepresentation). Nevertheless, only 12 were common with the top 1% of reactions identified by GNN. The 12 reactions largely represented cell signaling cascades by G-protein coupled receptors and fibroblast growth factor receptors (Fig. 4B). Notably, the common reactions identified did not include those ranked as most connected and significant using the GNN model. The number of genes identified uniquely or commonly by Differential Expression Analysis and the GNN. (A) Number of different and common genes between Differential Expression Analysis and GNN. (B) Number of different and common genes between Enrichment Analysis and GNN. Analysis of the differences in the most important responses obtained from the 3 centrality analysis methods. R-MMU-2559586: DNA damage/telomere stress induced senescence R-MMU-5693565: Recruitment and ATM-mediated phosphorylation of repair and signaling proteins at DNA double strand breaks R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69541: Stabilization of p53 R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69473: G2/M DNA damage checkpoint a A single reaction may be associated with several pathways in the Reactome database. Given the difference in sample sizes between treatment groups, as well as among available chemical exposure datasets, we aimed to identify whether the number of samples would influence the GNN’s ability to identify important reactions. The 0 and 30 µg/kg TCDD datasets were randomly sampled (equal group sizes maintained) from 10% to 90% in 10% intervals (Table S9; https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN model maintained a 100% accuracy rate demonstrating its robust classification capability even with minimal data. And to confirm robustness of findings, we randomly sampled at 90% and 10% 10 independent times to determine if the top contributing factors are consistent (Table S10; https://doi.org/10.5061/dryad.k3j9kd5kz). Although correlation coefficients were low (≤0.2), Spearman correlation analysis of reaction ranks between all pairwise comparisons showed significant correlation, largely driven by the highest-ranked reactions. The results confirm the robustness of the findings across the different random datasets, showing that the key contributing factors remain stable across the different sample sizes."
    },
    {
      "title": "Tissue classification performance by PCA",
      "text": "Dimensionality reduction using PCA was used to reduce the complexity of the dataset and visualize the main sources of variance across the samples, allowing for easier interpretation and identification of key patterns or clusters within the data. The proportion of variance explained by the first 10 principal components for all reactions shows that the first principal component captures a median 52% of the variance with the 25th and 75th percentiles spanning 33% to 88% (Fig. 1A). PC2 explained a median 24% of the variance with each subsequent principal component explaining less of the variance. This is consistent with reported TCGA reaction-wise principal components (Burkhart et al. 2023). Given that the first component captured most of the sample variance, PC1 was used for subsequent analyses. Training and validation of a reaction-based GNN on bulk RNA sequencing datasets from disparate mouse tissues. (A) Distribution of reaction-wise principal component score distribution for the first 10 components. A total of 9,844 reactions are shown and the box represents the median, 25th, and 75th percentiles. (B) Reaction-wise ARIs for each tissue were calculated following clustering using a KNN algorithm. Bars represent the average of the top 10 ARIs for each tissue. (C) Training performance at each epoch for GNN and ResNet18 models, as well as control datasets, using reaction-wise PC1 values. The final accuracy is shown in the figure legend. ROC curves are shown for validation datasets using the (D) GNN and (E) ResNet18 models. AUROCs are indicated next to sample labels for each tissue type. Additional performance metrics are in Table S4. A KNNs’ analysis of reaction-wise PC1 with 10-fold cross-validation further confirms that it is suitable to distinguish samples from individual tissues (Fig. 1B). Notably, the average ARI for the top 10 reactions of both the training and validation sets exceeds 80%, indicating excellent true positive classification using PC1 values. Further examination of the identity of the reactions with the highest ARI in each tissue finds reactions known to be representative of the tissue such as reactions related to the endoplasmic reticulum and Golgi transport in the liver, myosin and calcium in the heart, and keratin in the skin (File S1)."
    },
    {
      "title": "GNN and ResNet18 model training and validation",
      "text": "Following the training of the GNN and ResNet18 models, final accuracies at 500 epochs were 94% and 99%, respectively. Validation using the remaining 20% subset completed with accuracies of 93% and 99% for GNN and ResNet18, respectively (Fig. 1C). The high training accuracies demonstrate that both models effectively learned from the training data, whereas the similarly high validation accuracies suggest that the models generalize well to unseen data, indicating strong performance in classifying tissue types without overfitting. To ensure the lower limit of our training performance and evaluate whether GNN can capture the complex biological network, we apply 4 control datasets into GNN. A “Rewired Network” with randomly reconnected edges changes the network structure, demonstrating the importance of specific edge connections. A “Shuffled Features” randomizes the reaction-wise PC1 values, removing biological context to assess the contribution of these specific features. A “Shuffled Targets” set randomly assigns tissue labels, testing the importance of correct tissue labels for classification accuracy. A “Summation Dataset” sums the expression counts for a reaction instead of using a PC1 value to evaluate whether simpler features can provide comparable performance. As expected, both the GNN and ResNet18 models outperformed in classification accuracy compared with all control datasets (Fig. 1C). As Burkhart et al. (2023) demonstrated, ResNet18 performed better on the training data, however, in this study, there was no clear evidence that it may be overfitting on the training data. Further examination of the classification performance shows an AUROC≥0.84 for all tissues using the GNN model (Fig. 1D, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). ResNet18 showed a larger distribution in AUROC values performing more poorly for pancreas and skin samples and improved classification for muscle, main olfactory epithelium (MOE), intestine, and heart (Fig. 1E, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). However, ResNet18 appeared to generally perform better than the GNN in performance metrics (Table S5, Fig. S1A; https://doi.org/10.5061/dryad.k3j9kd5kz). To investigate potential bias or overfitting, we additionally performed a stratified 10-fold validation and 10 times repeated random subsampling validation (Fig. S3, File S3; https://doi.org/10.5061/dryad.k3j9kd5kz). Although the final model performance was generally good (>0.8), it was generally poorer in the stratified k-fold validation compared with random subsampling (Fig. S3). Anticipating that this may be due to the imbalanced tissue type representation, we examined the F1 score for each tissue following validation. A large amount of variation in classification performance was observed using both approaches with poorly represented tissues such as the mammary gland and thymus performing very poorly. Conversely, liver, which had the largest number of samples always performed well. Collectively, these analyses suggest better model performance for well-represented samples. Given that tissue types such as the liver represent more than 720 independently generated datasets, these 10-fold validations suggest that the model is not overfit for these tissues."
    },
    {
      "title": "GNN classification of TCDD-treated liver samples",
      "text": "Test liver samples represented by 4 independent studies were used to evaluate (i) binary dose classification (0 vs 30 µg/kg TCDD) or (ii) dose–response classification. Classification of binary dose groups consisted of 68 control and 68 treated samples, respectively. The dose–response analysis classification included 299 samples across 9 dose groups (0, 0.03, 0.01, 0.1, 0.3, 1, 3, 10, and 30 µg/kg). Initial analyses of test datasets completed after 500 epochs with an accuracy of 95% and 65% for the binary and dose–response datasets, respectively. The poor performance for the dose–response model suggested that the model performs poorly in conditions of gradual gene expression changes at intermediate doses which was confirmed when comparing to the ground truth (Fig. 2A). Testing performance for classification of TCDD test datasets by GNN model. Sample dose classification compared with ground truth from the GNN model (A) including or (B) excluding the time-course data (SRP131784). The point size represents the total number (log10 scale) of samples in each classification and true dose category. (C) Final accuracy at 500 epochs for the classification of the dose–response TCDD test dataset. Initial application of the GNN to the highest TCDD dose group compared with control revealed poor performance specifically for samples from the time-course dataset (SRA ID: SRP131784). This is likely due to the significant difference in exposure duration from acute (2 to 168 h) to subchronic (28 or 92 days). Therefore, SRP131784 was excluded from all subsequent analyses resulting in a final accuracy of 100% in the modeling of the binary dose dataset. Estimation of AUROC, F1 score, and MCC confirms perfect classification for binary comparison (Table S6; https://doi.org/10.5061/dryad.k3j9kd5kz). After exclusion of the time-course dataset, the dose–response classification accuracy increased to 76% (Table S7; https://doi.org/10.5061/dryad.k3j9kd5kz), and the target-prediction visualization displayed a more coherent trend extending from the left-bottom to the right-top corner (Fig. 2B). Although some noise persisted in the low doses (bottom-left), the clarity was notably enhanced. This observation suggests that when using small doses, the GNN model has difficulty capturing subtle transcriptomic changes, resulting in worse classification. To further evaluate the impact of dose-dependent changes, we performed independent pairwise comparisons for each dose group compared with control (e.g. 0.01 µg/kg TCDD vs control) resulting in a gradient in final accuracy that correlates to the increasing dose levels (Fig. 2C)."
    },
    {
      "title": "Key reactions identifying in interactive graph and centrality methods",
      "text": "Investigation of the top contributing reactions based on IG values in the binary classifications revealed variability despite the same reactions consistently ranking at the top (Table S8; https://doi.org/10.5061/dryad.k3j9kd5kz). Reactions associated with the largest IG values were often found to be located within small subnetworks which were not highly connected (Table 3, Fig. 3A, File S2). These represented reactions R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes) to R-MMU-8956140 (NEDD8 and UBD bind NUB1 and the 26S proteasome), part of the neddylation pathway, and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) involved in extracellular matrix remodeling. Visualization of key reaction nodes identified using IG values and centrality measurements. (A) Reactions identified as the highest IG values without centrality measurements found R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes”) to R-MMU-8956140 I (NEDD8 and UBD bind NUB1 and the 26S proteasome) and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) with IG values larger than 0.01. (B) Using closeness centrality analysis, key reactions found were R-MMU-6799246 (CHEK1 phosphorylates TP53) and R-MMU-5693609 (ATM phosphorylates TP53 at S15). (C) Eigenvector centrality found R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)). Top reactions (IG≥0.5) in the binary dose classification of TCDD. Given limited connectivity in the top edges, we applied network centrality measures to find highly connected reactions that drive treatment classification. Using Eigenvector and Closeness centrality, we found 3 key reactions: R-MMU-6799246 (CHEK1 phosphorylates TP53) was identified through closeness centrality, R-MMU-5693609 (ATM phosphorylates TP53 at S15) was identified through betweenness centrality (Fig. 3B, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz), and R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)) was identified through Eigenvector centrality (Fig. 3C, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz). These reactions are expected to play significant roles due to their influence within the network paired with high IG values (≥0.4)."
    },
    {
      "title": "Comparison to traditional differential expression analysis",
      "text": "We used traditional differential gene expression and PA methods and compared results to those from our GNN model. When examining differential expression of genes associated with the most important reactions for classification of treatment groups, we find that our GNN identifies genes which would not have been identified using a traditional approach (Table 4). Genes Uba2, Sae1, and Rwdd2b in reaction R-MMU-2993780 were found to be statistically significant (P-adjusted ≤0.05), but did not meet the fold-change criteria. Similarly, genes in reactions R-MMU-5693609 and R-MMU-6799246, such as Trp53 and Chek1, showed significant upregulation, with Chek1 showing the most notable change (3.7-fold increase). Comparison of genes identified by traditional differential expression analysis and the reactions connected to top 1% IG values found only 205 genes in common representing ≤10% of genes (Fig. 4A). Collectively, this comparison points to the identification of distinct genes of interest. PA found 101 enriched reactions using a traditional method (Fisher’s exact test for overrepresentation). Nevertheless, only 12 were common with the top 1% of reactions identified by GNN. The 12 reactions largely represented cell signaling cascades by G-protein coupled receptors and fibroblast growth factor receptors (Fig. 4B). Notably, the common reactions identified did not include those ranked as most connected and significant using the GNN model. The number of genes identified uniquely or commonly by Differential Expression Analysis and the GNN. (A) Number of different and common genes between Differential Expression Analysis and GNN. (B) Number of different and common genes between Enrichment Analysis and GNN. Analysis of the differences in the most important responses obtained from the 3 centrality analysis methods. R-MMU-2559586: DNA damage/telomere stress induced senescence R-MMU-5693565: Recruitment and ATM-mediated phosphorylation of repair and signaling proteins at DNA double strand breaks R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69541: Stabilization of p53 R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69473: G2/M DNA damage checkpoint a A single reaction may be associated with several pathways in the Reactome database."
    },
    {
      "title": "Sample size sensitivity analysis",
      "text": "Given the difference in sample sizes between treatment groups, as well as among available chemical exposure datasets, we aimed to identify whether the number of samples would influence the GNN’s ability to identify important reactions. The 0 and 30 µg/kg TCDD datasets were randomly sampled (equal group sizes maintained) from 10% to 90% in 10% intervals (Table S9; https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN model maintained a 100% accuracy rate demonstrating its robust classification capability even with minimal data. And to confirm robustness of findings, we randomly sampled at 90% and 10% 10 independent times to determine if the top contributing factors are consistent (Table S10; https://doi.org/10.5061/dryad.k3j9kd5kz). Although correlation coefficients were low (≤0.2), Spearman correlation analysis of reaction ranks between all pairwise comparisons showed significant correlation, largely driven by the highest-ranked reactions. The results confirm the robustness of the findings across the different random datasets, showing that the key contributing factors remain stable across the different sample sizes."
    },
    {
      "title": "Discussion",
      "text": "Recent years have seen a significant increase in the use of AI/ML methods to gain novel insight into disease and toxicity (Lin and Chou 2022; Kleinstreuer and Hartung 2024). Burkhart et al. (2023) demonstrated the application of a GNN on a metabolic reaction network showing the value of using a GNN for the identification of reaction subnetworks implicated in diseases such as psoriasis. In our study, we aimed to investigate whether using the same reaction network-based GNN approach could be used to identify toxicant disrupted reactions and pathways which may have thus far eluded us using traditional bulk RNA sequencing analysis workflows. Leveraging the vast amount of publicly available mouse RNA sequencing data, we hypothesized that a GNN model could be used to characterize chemical-specific perturbations of metabolism, providing mechanistic insight into toxicant-induced toxicities. In contrast to many existing applications of AI/ML in toxicogenomics which primarily use microarray data from a limited number of sources such as DrugMatrix or TG-GATEs (Chen et al. 2022; Li et al. 2024), we use publicly available data from GEO to expand the scope and sources highlighting the importance of the work from independent research groups. However, this also highlights that significant challenges remain in being able to develop and implement robust AI models on publicly available rodent toxicology datasets. The experimental workflow is summarized in Fig. S4. Our results show that leveraging knowledge about metabolic pathways and dimensionality reduction of gene expression data by metabolic reaction can effectively reduce the number of training parameters while maintaining very high classification accuracy for tissue types, even when the number of sample datasets was low. Although overfitting can be a common problem in applications of AI/ML, we did not see evidence of overfitting in our analyses. Both the GNN and ResNet18 performed with high accuracy with ResNet18 often performing better. We hypothesize that the additional noise in our mouse expression datasets, which were obtained from several disparate sources instead of initiatives such as the TCGA and GTEX, may have helped prevent overfitting (Fig. S1B; https://doi.org/10.5061/dryad.k3j9kd5kz). Although noise is generally considered detrimental to model performance, certain regularization techniques introduce controlled noise during training to enhance generalization and mitigate overfitting (Noh et al. 2017). Consequently, our analyses used the GNN model given its very close performance despite being simpler than ResNet18. The goal of this study was to identify putative novel mechanisms of chemical toxicity. Comparison of traditional PA and our GNN model showed very little agreement. This is not surprising as neural networks learn from hidden layers which can capture complex interactions. Although the 2 methods can be used to uncover mechanisms underlying chemical toxicity from transcriptomic data, they differ in their methodologies and interpretative capacities. Traditional PA relies on predefined databases, providing a transparent and interpretable framework for identifying disrupted pathways. Although this approach ensures reproducibility and clarity, it risks oversimplifying complex interactions and may overlook mechanisms not explicitly captured in existing databases. In contrast, neural networks utilize hidden layers to model complex interactions between genes and pathways, capturing latent representations of gene expression data that can reveal novel mechanisms previously inaccessible using traditional approaches. Although neural networks demonstrate robustness to noise and greater exploratory power, their “black-box” nature reduces interpretability and makes it challenging to directly trace predictions to specific genes or pathways. To address the interpretability challenges posed by neural networks, we use IG values to attribute model predictions to specific reactions and pathways. This approach allows us to uncover key pathways that may drive the observed toxicological mechanisms. Future work could further validate IG-based findings by correlating them with experimental or pathway enrichment data. Our GNN analysis, notably, did not identify reactions driven by aryl hydrocarbon receptor (AHR) battery genes such as Cyp1a1 and Cyp1a2, known targets of TCDD. Reactome is a database of endogenous reactions and while some chemical and drug metabolism reactions are represented, many, such as the transcription of Cyp1a1 by AHR: ARNT binding was not present in our mouse network. Nevertheless, several key reactions were identified as being disrupted. At a dose of 30 µg/kg, reactions represented the SUMOylation, P53 stabilization and phosphorylation, and cell cycle DNA damage checkpoint pathways. SUMOylation is reported to regulate the activity of the AHR and the AHR repressor, and TCDD can reduce SUMOylation of the AHR increasing its stability (Oshima et al. 2009; Xing et al. 2012). Similarly, TCDD has been experimentally shown to lead to cell cycle arrest (Jackson et al. 2014), and the AHR to regulate P53 protein levels (Moreno-Marín et al. 2018). Moreover, reactions identified as important with low connectivity, such as prolyl-4 hydroxylase and collagen biosynthesis, are consistent with histological findings in the studies from which these data were obtained (Nault et al. 2016; Fader et al. 2019). These findings suggest that using a more comprehensive metabolic network which incorporates adverse outcome pathways in future reaction-based GNN models could significantly improve classification of toxicants. In addition to the graph, performance of GNN models depends heavily on the quality of input data. One of the main challenges encountered during this study was collecting sufficient appropriate datasets for training and validating our GNN model. Although publicly deposited transcriptomic datasets have benefited from efforts like MIAME and MINSEQE to ensure public accessibility and standardization of metadata, challenges persist, particularly when applying ML approaches to nonhuman data. For environmental health science-focused studies, rodent data repositories such as DrugMatrix and TG-GATEs are available, but generally consist of a small number of samples (Ganter et al. 2006; Igarashi et al. 2015; Söllner et al. 2017), and were produced using microarrays rather than more modern next-generation sequencing. Consequently, we were unable to find enough samples from other toxicants or tissues to further investigate the generalizability of our model. Moreover, we cannot exclude the possibility that some of our datasets may represent sequencing reads from the same sample split across multiple sequencing lanes (Wilks et al. 2021), potentially introducing some bias. These challenges further highlight the need, and importance, of efforts to increase promote the Findable, Accessible, Interoperable, and Reusable data principles (Nault et al. 2023). Despite these challenges, our GNN model demonstrated strong performance even with limited data."
    },
    {
      "title": "Conclusion",
      "text": "To date, most applications of AI in environmental health sciences, especially those involving GNNs, have emphasized predictive approaches such as chemical and risk characterization and pharmacokinetics from structural information (Zaslavskiy et al. 2019; Cai et al. 2022; Chou and Lin 2023; Mehta et al. 2023; Tan et al. 2023), as well as from transcriptomic data (Mohsen et al. 2021; Chen et al. 2022; Kana et al. 2023; Li et al. 2023b). We hypothesized that the application of a GNN based on the network of metabolic reactions and pathways we can gain new insights into the metabolic perturbations elicited by toxicants such as TCDD from transcriptomic data. We demonstrate that the use of a GNN can facilitate the identification of metabolic reaction networks perturbed by toxicant exposure. Unlike traditional PA, which is limited by predefined databases and thresholds, the GNN model captured complex, latent interactions between genes and pathways revealing changes in SUMOylation, P53 stabilization, and extracellular matrix remodeling by TCDD. Collectively, we show that deep learning approaches can be a useful resource for the discovery of toxicant-induced metabolic perturbations. Efforts to establish more comprehensive and standardized rodent transcriptomics datasets are likely to further enhance the ability to unravel these complex mechanisms."
    }
  ],
  "full_text": "## Materials and methods\nIn this study examining the metabolic perturbations of a toxicant in mouse models, we applied the GNN approach developed by Burkhart et al. (2023) replacing the human reaction network with the mouse reaction network from Reactome (https://reactome.org/; version 89). Reactome is a manually curated human metabolic reaction network with orthologous reactions mapped in several other species including mouse (Fabregat et al. 2018). In this manuscript, a reaction is defined as a single step in a pathway (e.g. glucose 6-phosphate to glucono-1,5-lactone 6 phosphate in the pentose phosphate pathway). A detailed description of how the reaction network was built is provided in Supplementary Methods and based on publicly available code (https://github.com/joshuaburkhart/reticula/tree/master). All mouse transcriptomic datasets used in these analyses were obtained from the Recount3 pipeline (Wilks et al. 2021), and downloaded using the Recount3 package in R (v4.3.1). Recount3 represents the third iteration of the Recount project which processes publicly available data from human and mouse, processed through a uniform pipeline facilitating their comparison (Wilks et al. 2021; Razi et al. 2024). Data aligned to gencode_v26 were downloaded and the metadata extracted from the sra.experiment_attributes column of the R object. The metadata were further parsed to extract experimental design metadata including age, strain, sex, and treatment (Table S1; https://doi.org/10.5061/dryad.k3j9kd5kz). Because of inconsistent use of field names and values, datasets had to be subsequently manually curated. To train the GNN, samples were filtered to include only data from wild-type (any strain) naïve or control (treated only with vehicle) postnatal mouse datasets. We also excluded single-cell transcriptomic datasets or those generated from in vitro assays. We also manually curated tissue labels to collapse similar tissues into a single term (e.g. jejunum, duodenum, ileum, and colon were collapsed into intestine) due to the small number of samples for each when used separately. The initial number of samples was 225,558 which was filtered to 7,903 samples representing 26 different tissues from 720 independent project (SRP) IDs (Table 1, Table S2; https://doi.org/10.5061/dryad.k3j9kd5kz). Summary of tissue sample counts for the training and validation of GNN and ResNet18 models. Test datasets to evaluate metabolic perturbations elicited by treatment with a toxicant were similarly obtained from Recount3. We used datasets from livers of mice treated with the environmental contaminant TCDD as one of the most highly represented treatment paradigms with 5 independent datasets. The study designs for the 5 datasets were as follows: (1) male mice treated with vehicle or 30 µg/kg TCDD for 2, 4, 8, 12, 24, and 72 h (Nault et al. 2018); (2) male mice treated every 4 days for 28 days with 0, 0.01, 0.03, 0.1, 0.3, 1, 3, 10, or 30 µg/kg TCDD (Fader et al. 2017); (3) female mice treated every 4 days for 92 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2016); (4) female mice treated every 4 days for 28 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2015); (5) male mice treated every 4 days with sesame oil vehicle or 30 µg/kg TCDD for 28 days and tissues collected at Zeitgeber (ZT) times ZT0, ZT3, ZT6, ZT9, ZT12, ZT15, ZT18, and ZT21 (Fader et al. 2019). The initial number of test samples was 383, however, samples from the time-course study were eventually excluded as it impeded the model performance given such a large difference in the study design which is described in the “Results” section. With the exclusion of those samples, the final number of test samples was 299 (Table 2). Sample counts for each TCDD dose group. The gene expression count data were filtered to retain only the genes linked to Reactome reactions and removing any genes which were not expressed. Variance stabilizing transformation was applied using DESeq2 (Love et al. 2014). For each reaction, associated genes were subset and principal component analysis (PCA) was applied. The first component was kept for use in the GNN model. K-Nearest Neighbors (KNNs) algorithm using a 10-fold cross-validation method was used to confirm that reaction PC1 values could accurately classify tissues by calculating the average misclassification rate and the Adjusted Rand Index (ARI). As described by Burkhart et al. (2023), we initially tested both a GNN and ResNet18, an 18-layer CNN designed specifically for image classification (He et al. 2015). ResNet18, a well-established and high-performing neural network model traditionally used for image classification, is a suitable candidate for this problem due to its ability to extract hierarchical features from complex patterns, which can be leveraged to analyze metabolic reaction networks by representing reactions as grid-like feature structures. The GNN architecture used was based on that developed by Burkhart et al. (2023) which comprised 3 GraphConv layers from PyTorch Geometric, each mapping features to 64 hidden units. ReLU activation functions were applied after the first 2 graph convolution layers to handle nonlinear relationships. Global mean pooling was employed as the readout layer to aggregate node features into graph-level representations. A final linear layer converts these features into the number of tissue classification labels. To mitigate overfitting, a default dropout rate of 0.5 was applied before the final classification layer. For model training and validation, we used the Adam optimizer with default learning rate of 0.001 and cross-entropy loss function. The batch size was set to 64 to balance memory usage and computational efficiency. Model weights were initialized using PyTorch’s default initialization. The training and validation were conducted for a maximum of 500 epochs based on Burkhart’s experimental method, without implementing early stopping, to ensure comparability of results. Learning curves were monitored to confirm model convergence within this epoch limit. Samples were randomly assigned to either training (80%) or validation (20%) resulting in 6,288 training samples and 1,445 validation samples (Table 1). We started by classifying the 26 tissue types to establish tissue-specific reaction network states as weights within the GNN using the training data. The randomly selected validation dataset was represented by 13 tissue types. A maximum of 500 epochs was adopted based on previous performance demonstrations. Performance between GNN and ResNet18 was compared using the ARI, Mathews correlation coefficient (MCC), F1 score, precision, recall, and operating characteristic area under the receiver operating characteristic curve (AUROC) implemented with the sklearn.metrics package in Python. To evaluate putative biases and possibility of overfitting, we also performed a stratified 10-fold validation as well as 10 times repeated random subsampling train-validation split. To adapt the original GNN model to the testing (toxicant) dataset, we modified the network structure, focusing particularly on the final fully connected layer. This modification was necessary to accommodate the specific feature dimensions and the number of output classes in the new dataset. Specifically, we utilized the pretrained GNN model and applied transfer learning to enable effective prediction on the testing dataset (Li et al. 2023a). The original output layer, designed for predicting 26 classes, was replaced with a linear layer that has a matching number of output channels as dose labels. Specifically, when using all dose groups from the test datasets a total of 9 output channels was used. Similarly, for the binary dose classification a total of 2 output channels were used reflecting the control and 30 µg/kg groups. This adjustment ensured that the output dimensions aligned properly with the classification task. Additionally, we employed a parameter-freezing strategy to retain the representational power of the pretrained model while allowing the new final layer to adapt to the new task. Known as “partial parameter freezing” in transfer learning, this approach allows the pretrained model to maintain its learned feature extraction capabilities while effectively learning from the new dataset (Shen et al. 2021). Specifically, we froze the parameters of the initial layers in the GNN architecture and only allowed the final layer (i.e. lin.weight and lin.bias) to be updated. This method not only speeds up the training process but also improves the generalizability of the model (Li et al. 2023a). To understand the contributions of individual edges (reaction to reaction connection) to the GNN’s classification performance, we employed integrated gradients (IG) as previously described to calculate the gradients of edge weights (Sundararajan et al. 2017; Burkhart et al. 2023). IG is an attribution method that quantifies the impact of each input feature on the model’s predictions. Specifically, we used IG to compute the gradients with respect to the edge weights, serving as indicators of edge importance within the graph structure. IG gradients were sorted from highest to lowest and considered either the top 1% IG values or the top 100 IG values as the most important for subsequent analyses. To determine whether the same results were discoverable with varying sample sizes, we split our dataset into randomly selected 10% to 100% subsets. We computed eigenvector and closeness centrality measures for both criteria methods for top reactions (Table S3). Eigenvector centrality measures the influence of a node in a network by considering not only the number of direct connections it has but also the influence of those connected nodes. This allows us to identify responses that may have a small number of neighbors, but those neighbors are highly connected. Closeness centrality, on the other hand, focuses on the average shortest path between a node and all other nodes in the graph. This method helps identifying reactions that could easily affect or be affected by changes in other parts of the network. Differential gene expression analysis was performed using DESeq2 on the data prior to removing genes not represented in the mouse reaction network. Genes were considered differentially expressed when |log2(fold-change)|≥1.5 and P-adjusted value ≤0.05. Functional enrichment analysis of differentially expressed genes was used to compare the top identified reactions from the GNN analysis. Gene sets were generated from the same Reactome reactions used for the GNN, and enrichment analysis performed using the bc3net package in R. The enrichment was adjusted for multiple comparisons using the false discovery rate (FDR) method and reactions considered enriched when FDR≤0.05. All datasets used in this study were obtained from public repositories Recount3 and GEO. Accession IDs are provided in Tables S1 and S2 (https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN was generated as previously described using published analysis code (https://github.com/joshuaburkhart/reticula/tree/master) with modifications for use of mouse datasets and toxicogenomic data (https://github.com/jyb4444/Reticula_GNN; https://doi.org/10.5281/zenodo.15264946).\n\n## Creation of mouse metabolic reaction network\nIn this study examining the metabolic perturbations of a toxicant in mouse models, we applied the GNN approach developed by Burkhart et al. (2023) replacing the human reaction network with the mouse reaction network from Reactome (https://reactome.org/; version 89). Reactome is a manually curated human metabolic reaction network with orthologous reactions mapped in several other species including mouse (Fabregat et al. 2018). In this manuscript, a reaction is defined as a single step in a pathway (e.g. glucose 6-phosphate to glucono-1,5-lactone 6 phosphate in the pentose phosphate pathway). A detailed description of how the reaction network was built is provided in Supplementary Methods and based on publicly available code (https://github.com/joshuaburkhart/reticula/tree/master).\n\n## Description of training, validation, and test datasets\nAll mouse transcriptomic datasets used in these analyses were obtained from the Recount3 pipeline (Wilks et al. 2021), and downloaded using the Recount3 package in R (v4.3.1). Recount3 represents the third iteration of the Recount project which processes publicly available data from human and mouse, processed through a uniform pipeline facilitating their comparison (Wilks et al. 2021; Razi et al. 2024). Data aligned to gencode_v26 were downloaded and the metadata extracted from the sra.experiment_attributes column of the R object. The metadata were further parsed to extract experimental design metadata including age, strain, sex, and treatment (Table S1; https://doi.org/10.5061/dryad.k3j9kd5kz). Because of inconsistent use of field names and values, datasets had to be subsequently manually curated. To train the GNN, samples were filtered to include only data from wild-type (any strain) naïve or control (treated only with vehicle) postnatal mouse datasets. We also excluded single-cell transcriptomic datasets or those generated from in vitro assays. We also manually curated tissue labels to collapse similar tissues into a single term (e.g. jejunum, duodenum, ileum, and colon were collapsed into intestine) due to the small number of samples for each when used separately. The initial number of samples was 225,558 which was filtered to 7,903 samples representing 26 different tissues from 720 independent project (SRP) IDs (Table 1, Table S2; https://doi.org/10.5061/dryad.k3j9kd5kz). Summary of tissue sample counts for the training and validation of GNN and ResNet18 models. Test datasets to evaluate metabolic perturbations elicited by treatment with a toxicant were similarly obtained from Recount3. We used datasets from livers of mice treated with the environmental contaminant TCDD as one of the most highly represented treatment paradigms with 5 independent datasets. The study designs for the 5 datasets were as follows: (1) male mice treated with vehicle or 30 µg/kg TCDD for 2, 4, 8, 12, 24, and 72 h (Nault et al. 2018); (2) male mice treated every 4 days for 28 days with 0, 0.01, 0.03, 0.1, 0.3, 1, 3, 10, or 30 µg/kg TCDD (Fader et al. 2017); (3) female mice treated every 4 days for 92 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2016); (4) female mice treated every 4 days for 28 days with 0.01, 0.03, 0.1, 0.3, 1, 3, 10, 30 µg/kg TCDD (Nault et al. 2015); (5) male mice treated every 4 days with sesame oil vehicle or 30 µg/kg TCDD for 28 days and tissues collected at Zeitgeber (ZT) times ZT0, ZT3, ZT6, ZT9, ZT12, ZT15, ZT18, and ZT21 (Fader et al. 2019). The initial number of test samples was 383, however, samples from the time-course study were eventually excluded as it impeded the model performance given such a large difference in the study design which is described in the “Results” section. With the exclusion of those samples, the final number of test samples was 299 (Table 2). Sample counts for each TCDD dose group.\n\n## Transcriptomic data preprocessing\nThe gene expression count data were filtered to retain only the genes linked to Reactome reactions and removing any genes which were not expressed. Variance stabilizing transformation was applied using DESeq2 (Love et al. 2014). For each reaction, associated genes were subset and principal component analysis (PCA) was applied. The first component was kept for use in the GNN model. K-Nearest Neighbors (KNNs) algorithm using a 10-fold cross-validation method was used to confirm that reaction PC1 values could accurately classify tissues by calculating the average misclassification rate and the Adjusted Rand Index (ARI).\n\n## Model setup description\nAs described by Burkhart et al. (2023), we initially tested both a GNN and ResNet18, an 18-layer CNN designed specifically for image classification (He et al. 2015). ResNet18, a well-established and high-performing neural network model traditionally used for image classification, is a suitable candidate for this problem due to its ability to extract hierarchical features from complex patterns, which can be leveraged to analyze metabolic reaction networks by representing reactions as grid-like feature structures. The GNN architecture used was based on that developed by Burkhart et al. (2023) which comprised 3 GraphConv layers from PyTorch Geometric, each mapping features to 64 hidden units. ReLU activation functions were applied after the first 2 graph convolution layers to handle nonlinear relationships. Global mean pooling was employed as the readout layer to aggregate node features into graph-level representations. A final linear layer converts these features into the number of tissue classification labels. To mitigate overfitting, a default dropout rate of 0.5 was applied before the final classification layer. For model training and validation, we used the Adam optimizer with default learning rate of 0.001 and cross-entropy loss function. The batch size was set to 64 to balance memory usage and computational efficiency. Model weights were initialized using PyTorch’s default initialization. The training and validation were conducted for a maximum of 500 epochs based on Burkhart’s experimental method, without implementing early stopping, to ensure comparability of results. Learning curves were monitored to confirm model convergence within this epoch limit.\n\n## Training and validation of GNN\nSamples were randomly assigned to either training (80%) or validation (20%) resulting in 6,288 training samples and 1,445 validation samples (Table 1). We started by classifying the 26 tissue types to establish tissue-specific reaction network states as weights within the GNN using the training data. The randomly selected validation dataset was represented by 13 tissue types. A maximum of 500 epochs was adopted based on previous performance demonstrations. Performance between GNN and ResNet18 was compared using the ARI, Mathews correlation coefficient (MCC), F1 score, precision, recall, and operating characteristic area under the receiver operating characteristic curve (AUROC) implemented with the sklearn.metrics package in Python. To evaluate putative biases and possibility of overfitting, we also performed a stratified 10-fold validation as well as 10 times repeated random subsampling train-validation split.\n\n## Application of GNN for investigating toxicant-induced changes\nTo adapt the original GNN model to the testing (toxicant) dataset, we modified the network structure, focusing particularly on the final fully connected layer. This modification was necessary to accommodate the specific feature dimensions and the number of output classes in the new dataset. Specifically, we utilized the pretrained GNN model and applied transfer learning to enable effective prediction on the testing dataset (Li et al. 2023a). The original output layer, designed for predicting 26 classes, was replaced with a linear layer that has a matching number of output channels as dose labels. Specifically, when using all dose groups from the test datasets a total of 9 output channels was used. Similarly, for the binary dose classification a total of 2 output channels were used reflecting the control and 30 µg/kg groups. This adjustment ensured that the output dimensions aligned properly with the classification task. Additionally, we employed a parameter-freezing strategy to retain the representational power of the pretrained model while allowing the new final layer to adapt to the new task. Known as “partial parameter freezing” in transfer learning, this approach allows the pretrained model to maintain its learned feature extraction capabilities while effectively learning from the new dataset (Shen et al. 2021). Specifically, we froze the parameters of the initial layers in the GNN architecture and only allowed the final layer (i.e. lin.weight and lin.bias) to be updated. This method not only speeds up the training process but also improves the generalizability of the model (Li et al. 2023a).\n\n## Estimating edge importance attribution using integrated gradients\nTo understand the contributions of individual edges (reaction to reaction connection) to the GNN’s classification performance, we employed integrated gradients (IG) as previously described to calculate the gradients of edge weights (Sundararajan et al. 2017; Burkhart et al. 2023). IG is an attribution method that quantifies the impact of each input feature on the model’s predictions. Specifically, we used IG to compute the gradients with respect to the edge weights, serving as indicators of edge importance within the graph structure.\n\n## Centrality-based network analysis of reactions\nIG gradients were sorted from highest to lowest and considered either the top 1% IG values or the top 100 IG values as the most important for subsequent analyses. To determine whether the same results were discoverable with varying sample sizes, we split our dataset into randomly selected 10% to 100% subsets. We computed eigenvector and closeness centrality measures for both criteria methods for top reactions (Table S3). Eigenvector centrality measures the influence of a node in a network by considering not only the number of direct connections it has but also the influence of those connected nodes. This allows us to identify responses that may have a small number of neighbors, but those neighbors are highly connected. Closeness centrality, on the other hand, focuses on the average shortest path between a node and all other nodes in the graph. This method helps identifying reactions that could easily affect or be affected by changes in other parts of the network.\n\n## Traditional differential gene expression analysis and functional enrichment analysis\nDifferential gene expression analysis was performed using DESeq2 on the data prior to removing genes not represented in the mouse reaction network. Genes were considered differentially expressed when |log2(fold-change)|≥1.5 and P-adjusted value ≤0.05. Functional enrichment analysis of differentially expressed genes was used to compare the top identified reactions from the GNN analysis. Gene sets were generated from the same Reactome reactions used for the GNN, and enrichment analysis performed using the bc3net package in R. The enrichment was adjusted for multiple comparisons using the false discovery rate (FDR) method and reactions considered enriched when FDR≤0.05.\n\n## Data and code availability\nAll datasets used in this study were obtained from public repositories Recount3 and GEO. Accession IDs are provided in Tables S1 and S2 (https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN was generated as previously described using published analysis code (https://github.com/joshuaburkhart/reticula/tree/master) with modifications for use of mouse datasets and toxicogenomic data (https://github.com/jyb4444/Reticula_GNN; https://doi.org/10.5281/zenodo.15264946).\n\n## Results\nDimensionality reduction using PCA was used to reduce the complexity of the dataset and visualize the main sources of variance across the samples, allowing for easier interpretation and identification of key patterns or clusters within the data. The proportion of variance explained by the first 10 principal components for all reactions shows that the first principal component captures a median 52% of the variance with the 25th and 75th percentiles spanning 33% to 88% (Fig. 1A). PC2 explained a median 24% of the variance with each subsequent principal component explaining less of the variance. This is consistent with reported TCGA reaction-wise principal components (Burkhart et al. 2023). Given that the first component captured most of the sample variance, PC1 was used for subsequent analyses. Training and validation of a reaction-based GNN on bulk RNA sequencing datasets from disparate mouse tissues. (A) Distribution of reaction-wise principal component score distribution for the first 10 components. A total of 9,844 reactions are shown and the box represents the median, 25th, and 75th percentiles. (B) Reaction-wise ARIs for each tissue were calculated following clustering using a KNN algorithm. Bars represent the average of the top 10 ARIs for each tissue. (C) Training performance at each epoch for GNN and ResNet18 models, as well as control datasets, using reaction-wise PC1 values. The final accuracy is shown in the figure legend. ROC curves are shown for validation datasets using the (D) GNN and (E) ResNet18 models. AUROCs are indicated next to sample labels for each tissue type. Additional performance metrics are in Table S4. A KNNs’ analysis of reaction-wise PC1 with 10-fold cross-validation further confirms that it is suitable to distinguish samples from individual tissues (Fig. 1B). Notably, the average ARI for the top 10 reactions of both the training and validation sets exceeds 80%, indicating excellent true positive classification using PC1 values. Further examination of the identity of the reactions with the highest ARI in each tissue finds reactions known to be representative of the tissue such as reactions related to the endoplasmic reticulum and Golgi transport in the liver, myosin and calcium in the heart, and keratin in the skin (File S1). Following the training of the GNN and ResNet18 models, final accuracies at 500 epochs were 94% and 99%, respectively. Validation using the remaining 20% subset completed with accuracies of 93% and 99% for GNN and ResNet18, respectively (Fig. 1C). The high training accuracies demonstrate that both models effectively learned from the training data, whereas the similarly high validation accuracies suggest that the models generalize well to unseen data, indicating strong performance in classifying tissue types without overfitting. To ensure the lower limit of our training performance and evaluate whether GNN can capture the complex biological network, we apply 4 control datasets into GNN. A “Rewired Network” with randomly reconnected edges changes the network structure, demonstrating the importance of specific edge connections. A “Shuffled Features” randomizes the reaction-wise PC1 values, removing biological context to assess the contribution of these specific features. A “Shuffled Targets” set randomly assigns tissue labels, testing the importance of correct tissue labels for classification accuracy. A “Summation Dataset” sums the expression counts for a reaction instead of using a PC1 value to evaluate whether simpler features can provide comparable performance. As expected, both the GNN and ResNet18 models outperformed in classification accuracy compared with all control datasets (Fig. 1C). As Burkhart et al. (2023) demonstrated, ResNet18 performed better on the training data, however, in this study, there was no clear evidence that it may be overfitting on the training data. Further examination of the classification performance shows an AUROC≥0.84 for all tissues using the GNN model (Fig. 1D, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). ResNet18 showed a larger distribution in AUROC values performing more poorly for pancreas and skin samples and improved classification for muscle, main olfactory epithelium (MOE), intestine, and heart (Fig. 1E, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). However, ResNet18 appeared to generally perform better than the GNN in performance metrics (Table S5, Fig. S1A; https://doi.org/10.5061/dryad.k3j9kd5kz). To investigate potential bias or overfitting, we additionally performed a stratified 10-fold validation and 10 times repeated random subsampling validation (Fig. S3, File S3; https://doi.org/10.5061/dryad.k3j9kd5kz). Although the final model performance was generally good (>0.8), it was generally poorer in the stratified k-fold validation compared with random subsampling (Fig. S3). Anticipating that this may be due to the imbalanced tissue type representation, we examined the F1 score for each tissue following validation. A large amount of variation in classification performance was observed using both approaches with poorly represented tissues such as the mammary gland and thymus performing very poorly. Conversely, liver, which had the largest number of samples always performed well. Collectively, these analyses suggest better model performance for well-represented samples. Given that tissue types such as the liver represent more than 720 independently generated datasets, these 10-fold validations suggest that the model is not overfit for these tissues. Test liver samples represented by 4 independent studies were used to evaluate (i) binary dose classification (0 vs 30 µg/kg TCDD) or (ii) dose–response classification. Classification of binary dose groups consisted of 68 control and 68 treated samples, respectively. The dose–response analysis classification included 299 samples across 9 dose groups (0, 0.03, 0.01, 0.1, 0.3, 1, 3, 10, and 30 µg/kg). Initial analyses of test datasets completed after 500 epochs with an accuracy of 95% and 65% for the binary and dose–response datasets, respectively. The poor performance for the dose–response model suggested that the model performs poorly in conditions of gradual gene expression changes at intermediate doses which was confirmed when comparing to the ground truth (Fig. 2A). Testing performance for classification of TCDD test datasets by GNN model. Sample dose classification compared with ground truth from the GNN model (A) including or (B) excluding the time-course data (SRP131784). The point size represents the total number (log10 scale) of samples in each classification and true dose category. (C) Final accuracy at 500 epochs for the classification of the dose–response TCDD test dataset. Initial application of the GNN to the highest TCDD dose group compared with control revealed poor performance specifically for samples from the time-course dataset (SRA ID: SRP131784). This is likely due to the significant difference in exposure duration from acute (2 to 168 h) to subchronic (28 or 92 days). Therefore, SRP131784 was excluded from all subsequent analyses resulting in a final accuracy of 100% in the modeling of the binary dose dataset. Estimation of AUROC, F1 score, and MCC confirms perfect classification for binary comparison (Table S6; https://doi.org/10.5061/dryad.k3j9kd5kz). After exclusion of the time-course dataset, the dose–response classification accuracy increased to 76% (Table S7; https://doi.org/10.5061/dryad.k3j9kd5kz), and the target-prediction visualization displayed a more coherent trend extending from the left-bottom to the right-top corner (Fig. 2B). Although some noise persisted in the low doses (bottom-left), the clarity was notably enhanced. This observation suggests that when using small doses, the GNN model has difficulty capturing subtle transcriptomic changes, resulting in worse classification. To further evaluate the impact of dose-dependent changes, we performed independent pairwise comparisons for each dose group compared with control (e.g. 0.01 µg/kg TCDD vs control) resulting in a gradient in final accuracy that correlates to the increasing dose levels (Fig. 2C). Investigation of the top contributing reactions based on IG values in the binary classifications revealed variability despite the same reactions consistently ranking at the top (Table S8; https://doi.org/10.5061/dryad.k3j9kd5kz). Reactions associated with the largest IG values were often found to be located within small subnetworks which were not highly connected (Table 3, Fig. 3A, File S2). These represented reactions R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes) to R-MMU-8956140 (NEDD8 and UBD bind NUB1 and the 26S proteasome), part of the neddylation pathway, and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) involved in extracellular matrix remodeling. Visualization of key reaction nodes identified using IG values and centrality measurements. (A) Reactions identified as the highest IG values without centrality measurements found R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes”) to R-MMU-8956140 I (NEDD8 and UBD bind NUB1 and the 26S proteasome) and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) with IG values larger than 0.01. (B) Using closeness centrality analysis, key reactions found were R-MMU-6799246 (CHEK1 phosphorylates TP53) and R-MMU-5693609 (ATM phosphorylates TP53 at S15). (C) Eigenvector centrality found R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)). Top reactions (IG≥0.5) in the binary dose classification of TCDD. Given limited connectivity in the top edges, we applied network centrality measures to find highly connected reactions that drive treatment classification. Using Eigenvector and Closeness centrality, we found 3 key reactions: R-MMU-6799246 (CHEK1 phosphorylates TP53) was identified through closeness centrality, R-MMU-5693609 (ATM phosphorylates TP53 at S15) was identified through betweenness centrality (Fig. 3B, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz), and R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)) was identified through Eigenvector centrality (Fig. 3C, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz). These reactions are expected to play significant roles due to their influence within the network paired with high IG values (≥0.4). We used traditional differential gene expression and PA methods and compared results to those from our GNN model. When examining differential expression of genes associated with the most important reactions for classification of treatment groups, we find that our GNN identifies genes which would not have been identified using a traditional approach (Table 4). Genes Uba2, Sae1, and Rwdd2b in reaction R-MMU-2993780 were found to be statistically significant (P-adjusted ≤0.05), but did not meet the fold-change criteria. Similarly, genes in reactions R-MMU-5693609 and R-MMU-6799246, such as Trp53 and Chek1, showed significant upregulation, with Chek1 showing the most notable change (3.7-fold increase). Comparison of genes identified by traditional differential expression analysis and the reactions connected to top 1% IG values found only 205 genes in common representing ≤10% of genes (Fig. 4A). Collectively, this comparison points to the identification of distinct genes of interest. PA found 101 enriched reactions using a traditional method (Fisher’s exact test for overrepresentation). Nevertheless, only 12 were common with the top 1% of reactions identified by GNN. The 12 reactions largely represented cell signaling cascades by G-protein coupled receptors and fibroblast growth factor receptors (Fig. 4B). Notably, the common reactions identified did not include those ranked as most connected and significant using the GNN model. The number of genes identified uniquely or commonly by Differential Expression Analysis and the GNN. (A) Number of different and common genes between Differential Expression Analysis and GNN. (B) Number of different and common genes between Enrichment Analysis and GNN. Analysis of the differences in the most important responses obtained from the 3 centrality analysis methods. R-MMU-2559586: DNA damage/telomere stress induced senescence R-MMU-5693565: Recruitment and ATM-mediated phosphorylation of repair and signaling proteins at DNA double strand breaks R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69541: Stabilization of p53 R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69473: G2/M DNA damage checkpoint a A single reaction may be associated with several pathways in the Reactome database. Given the difference in sample sizes between treatment groups, as well as among available chemical exposure datasets, we aimed to identify whether the number of samples would influence the GNN’s ability to identify important reactions. The 0 and 30 µg/kg TCDD datasets were randomly sampled (equal group sizes maintained) from 10% to 90% in 10% intervals (Table S9; https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN model maintained a 100% accuracy rate demonstrating its robust classification capability even with minimal data. And to confirm robustness of findings, we randomly sampled at 90% and 10% 10 independent times to determine if the top contributing factors are consistent (Table S10; https://doi.org/10.5061/dryad.k3j9kd5kz). Although correlation coefficients were low (≤0.2), Spearman correlation analysis of reaction ranks between all pairwise comparisons showed significant correlation, largely driven by the highest-ranked reactions. The results confirm the robustness of the findings across the different random datasets, showing that the key contributing factors remain stable across the different sample sizes.\n\n## Tissue classification performance by PCA\nDimensionality reduction using PCA was used to reduce the complexity of the dataset and visualize the main sources of variance across the samples, allowing for easier interpretation and identification of key patterns or clusters within the data. The proportion of variance explained by the first 10 principal components for all reactions shows that the first principal component captures a median 52% of the variance with the 25th and 75th percentiles spanning 33% to 88% (Fig. 1A). PC2 explained a median 24% of the variance with each subsequent principal component explaining less of the variance. This is consistent with reported TCGA reaction-wise principal components (Burkhart et al. 2023). Given that the first component captured most of the sample variance, PC1 was used for subsequent analyses. Training and validation of a reaction-based GNN on bulk RNA sequencing datasets from disparate mouse tissues. (A) Distribution of reaction-wise principal component score distribution for the first 10 components. A total of 9,844 reactions are shown and the box represents the median, 25th, and 75th percentiles. (B) Reaction-wise ARIs for each tissue were calculated following clustering using a KNN algorithm. Bars represent the average of the top 10 ARIs for each tissue. (C) Training performance at each epoch for GNN and ResNet18 models, as well as control datasets, using reaction-wise PC1 values. The final accuracy is shown in the figure legend. ROC curves are shown for validation datasets using the (D) GNN and (E) ResNet18 models. AUROCs are indicated next to sample labels for each tissue type. Additional performance metrics are in Table S4. A KNNs’ analysis of reaction-wise PC1 with 10-fold cross-validation further confirms that it is suitable to distinguish samples from individual tissues (Fig. 1B). Notably, the average ARI for the top 10 reactions of both the training and validation sets exceeds 80%, indicating excellent true positive classification using PC1 values. Further examination of the identity of the reactions with the highest ARI in each tissue finds reactions known to be representative of the tissue such as reactions related to the endoplasmic reticulum and Golgi transport in the liver, myosin and calcium in the heart, and keratin in the skin (File S1).\n\n## GNN and ResNet18 model training and validation\nFollowing the training of the GNN and ResNet18 models, final accuracies at 500 epochs were 94% and 99%, respectively. Validation using the remaining 20% subset completed with accuracies of 93% and 99% for GNN and ResNet18, respectively (Fig. 1C). The high training accuracies demonstrate that both models effectively learned from the training data, whereas the similarly high validation accuracies suggest that the models generalize well to unseen data, indicating strong performance in classifying tissue types without overfitting. To ensure the lower limit of our training performance and evaluate whether GNN can capture the complex biological network, we apply 4 control datasets into GNN. A “Rewired Network” with randomly reconnected edges changes the network structure, demonstrating the importance of specific edge connections. A “Shuffled Features” randomizes the reaction-wise PC1 values, removing biological context to assess the contribution of these specific features. A “Shuffled Targets” set randomly assigns tissue labels, testing the importance of correct tissue labels for classification accuracy. A “Summation Dataset” sums the expression counts for a reaction instead of using a PC1 value to evaluate whether simpler features can provide comparable performance. As expected, both the GNN and ResNet18 models outperformed in classification accuracy compared with all control datasets (Fig. 1C). As Burkhart et al. (2023) demonstrated, ResNet18 performed better on the training data, however, in this study, there was no clear evidence that it may be overfitting on the training data. Further examination of the classification performance shows an AUROC≥0.84 for all tissues using the GNN model (Fig. 1D, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). ResNet18 showed a larger distribution in AUROC values performing more poorly for pancreas and skin samples and improved classification for muscle, main olfactory epithelium (MOE), intestine, and heart (Fig. 1E, Table S4; https://doi.org/10.5061/dryad.k3j9kd5kz). However, ResNet18 appeared to generally perform better than the GNN in performance metrics (Table S5, Fig. S1A; https://doi.org/10.5061/dryad.k3j9kd5kz). To investigate potential bias or overfitting, we additionally performed a stratified 10-fold validation and 10 times repeated random subsampling validation (Fig. S3, File S3; https://doi.org/10.5061/dryad.k3j9kd5kz). Although the final model performance was generally good (>0.8), it was generally poorer in the stratified k-fold validation compared with random subsampling (Fig. S3). Anticipating that this may be due to the imbalanced tissue type representation, we examined the F1 score for each tissue following validation. A large amount of variation in classification performance was observed using both approaches with poorly represented tissues such as the mammary gland and thymus performing very poorly. Conversely, liver, which had the largest number of samples always performed well. Collectively, these analyses suggest better model performance for well-represented samples. Given that tissue types such as the liver represent more than 720 independently generated datasets, these 10-fold validations suggest that the model is not overfit for these tissues.\n\n## GNN classification of TCDD-treated liver samples\nTest liver samples represented by 4 independent studies were used to evaluate (i) binary dose classification (0 vs 30 µg/kg TCDD) or (ii) dose–response classification. Classification of binary dose groups consisted of 68 control and 68 treated samples, respectively. The dose–response analysis classification included 299 samples across 9 dose groups (0, 0.03, 0.01, 0.1, 0.3, 1, 3, 10, and 30 µg/kg). Initial analyses of test datasets completed after 500 epochs with an accuracy of 95% and 65% for the binary and dose–response datasets, respectively. The poor performance for the dose–response model suggested that the model performs poorly in conditions of gradual gene expression changes at intermediate doses which was confirmed when comparing to the ground truth (Fig. 2A). Testing performance for classification of TCDD test datasets by GNN model. Sample dose classification compared with ground truth from the GNN model (A) including or (B) excluding the time-course data (SRP131784). The point size represents the total number (log10 scale) of samples in each classification and true dose category. (C) Final accuracy at 500 epochs for the classification of the dose–response TCDD test dataset. Initial application of the GNN to the highest TCDD dose group compared with control revealed poor performance specifically for samples from the time-course dataset (SRA ID: SRP131784). This is likely due to the significant difference in exposure duration from acute (2 to 168 h) to subchronic (28 or 92 days). Therefore, SRP131784 was excluded from all subsequent analyses resulting in a final accuracy of 100% in the modeling of the binary dose dataset. Estimation of AUROC, F1 score, and MCC confirms perfect classification for binary comparison (Table S6; https://doi.org/10.5061/dryad.k3j9kd5kz). After exclusion of the time-course dataset, the dose–response classification accuracy increased to 76% (Table S7; https://doi.org/10.5061/dryad.k3j9kd5kz), and the target-prediction visualization displayed a more coherent trend extending from the left-bottom to the right-top corner (Fig. 2B). Although some noise persisted in the low doses (bottom-left), the clarity was notably enhanced. This observation suggests that when using small doses, the GNN model has difficulty capturing subtle transcriptomic changes, resulting in worse classification. To further evaluate the impact of dose-dependent changes, we performed independent pairwise comparisons for each dose group compared with control (e.g. 0.01 µg/kg TCDD vs control) resulting in a gradient in final accuracy that correlates to the increasing dose levels (Fig. 2C).\n\n## Key reactions identifying in interactive graph and centrality methods\nInvestigation of the top contributing reactions based on IG values in the binary classifications revealed variability despite the same reactions consistently ranking at the top (Table S8; https://doi.org/10.5061/dryad.k3j9kd5kz). Reactions associated with the largest IG values were often found to be located within small subnetworks which were not highly connected (Table 3, Fig. 3A, File S2). These represented reactions R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes) to R-MMU-8956140 (NEDD8 and UBD bind NUB1 and the 26S proteasome), part of the neddylation pathway, and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) involved in extracellular matrix remodeling. Visualization of key reaction nodes identified using IG values and centrality measurements. (A) Reactions identified as the highest IG values without centrality measurements found R-MMU-8956040 (COP9 signalosome deneddylates cytosolic CRL E3 ubiquitin ligase complexes”) to R-MMU-8956140 I (NEDD8 and UBD bind NUB1 and the 26S proteasome) and R-MMU-2002460 (P4HB binds Collagen chains) to R-MMU-1650808 (Prolyl 4-hydroxylase converts collagen prolines to 4-hydroxyprolines) with IG values larger than 0.01. (B) Using closeness centrality analysis, key reactions found were R-MMU-6799246 (CHEK1 phosphorylates TP53) and R-MMU-5693609 (ATM phosphorylates TP53 at S15). (C) Eigenvector centrality found R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)). Top reactions (IG≥0.5) in the binary dose classification of TCDD. Given limited connectivity in the top edges, we applied network centrality measures to find highly connected reactions that drive treatment classification. Using Eigenvector and Closeness centrality, we found 3 key reactions: R-MMU-6799246 (CHEK1 phosphorylates TP53) was identified through closeness centrality, R-MMU-5693609 (ATM phosphorylates TP53 at S15) was identified through betweenness centrality (Fig. 3B, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz), and R-MMU-2993780 (Transfer of SUMO1 from E1 to UBE2I (UBC9)) was identified through Eigenvector centrality (Fig. 3C, Table S3; https://doi.org/10.5061/dryad.k3j9kd5kz). These reactions are expected to play significant roles due to their influence within the network paired with high IG values (≥0.4).\n\n## Comparison to traditional differential expression analysis\nWe used traditional differential gene expression and PA methods and compared results to those from our GNN model. When examining differential expression of genes associated with the most important reactions for classification of treatment groups, we find that our GNN identifies genes which would not have been identified using a traditional approach (Table 4). Genes Uba2, Sae1, and Rwdd2b in reaction R-MMU-2993780 were found to be statistically significant (P-adjusted ≤0.05), but did not meet the fold-change criteria. Similarly, genes in reactions R-MMU-5693609 and R-MMU-6799246, such as Trp53 and Chek1, showed significant upregulation, with Chek1 showing the most notable change (3.7-fold increase). Comparison of genes identified by traditional differential expression analysis and the reactions connected to top 1% IG values found only 205 genes in common representing ≤10% of genes (Fig. 4A). Collectively, this comparison points to the identification of distinct genes of interest. PA found 101 enriched reactions using a traditional method (Fisher’s exact test for overrepresentation). Nevertheless, only 12 were common with the top 1% of reactions identified by GNN. The 12 reactions largely represented cell signaling cascades by G-protein coupled receptors and fibroblast growth factor receptors (Fig. 4B). Notably, the common reactions identified did not include those ranked as most connected and significant using the GNN model. The number of genes identified uniquely or commonly by Differential Expression Analysis and the GNN. (A) Number of different and common genes between Differential Expression Analysis and GNN. (B) Number of different and common genes between Enrichment Analysis and GNN. Analysis of the differences in the most important responses obtained from the 3 centrality analysis methods. R-MMU-2559586: DNA damage/telomere stress induced senescence R-MMU-5693565: Recruitment and ATM-mediated phosphorylation of repair and signaling proteins at DNA double strand breaks R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69541: Stabilization of p53 R-MMU-6804756: Regulation of TP53 activity through phosphorylation R-MMU-69473: G2/M DNA damage checkpoint a A single reaction may be associated with several pathways in the Reactome database.\n\n## Sample size sensitivity analysis\nGiven the difference in sample sizes between treatment groups, as well as among available chemical exposure datasets, we aimed to identify whether the number of samples would influence the GNN’s ability to identify important reactions. The 0 and 30 µg/kg TCDD datasets were randomly sampled (equal group sizes maintained) from 10% to 90% in 10% intervals (Table S9; https://doi.org/10.5061/dryad.k3j9kd5kz). The GNN model maintained a 100% accuracy rate demonstrating its robust classification capability even with minimal data. And to confirm robustness of findings, we randomly sampled at 90% and 10% 10 independent times to determine if the top contributing factors are consistent (Table S10; https://doi.org/10.5061/dryad.k3j9kd5kz). Although correlation coefficients were low (≤0.2), Spearman correlation analysis of reaction ranks between all pairwise comparisons showed significant correlation, largely driven by the highest-ranked reactions. The results confirm the robustness of the findings across the different random datasets, showing that the key contributing factors remain stable across the different sample sizes.\n\n## Discussion\nRecent years have seen a significant increase in the use of AI/ML methods to gain novel insight into disease and toxicity (Lin and Chou 2022; Kleinstreuer and Hartung 2024). Burkhart et al. (2023) demonstrated the application of a GNN on a metabolic reaction network showing the value of using a GNN for the identification of reaction subnetworks implicated in diseases such as psoriasis. In our study, we aimed to investigate whether using the same reaction network-based GNN approach could be used to identify toxicant disrupted reactions and pathways which may have thus far eluded us using traditional bulk RNA sequencing analysis workflows. Leveraging the vast amount of publicly available mouse RNA sequencing data, we hypothesized that a GNN model could be used to characterize chemical-specific perturbations of metabolism, providing mechanistic insight into toxicant-induced toxicities. In contrast to many existing applications of AI/ML in toxicogenomics which primarily use microarray data from a limited number of sources such as DrugMatrix or TG-GATEs (Chen et al. 2022; Li et al. 2024), we use publicly available data from GEO to expand the scope and sources highlighting the importance of the work from independent research groups. However, this also highlights that significant challenges remain in being able to develop and implement robust AI models on publicly available rodent toxicology datasets. The experimental workflow is summarized in Fig. S4. Our results show that leveraging knowledge about metabolic pathways and dimensionality reduction of gene expression data by metabolic reaction can effectively reduce the number of training parameters while maintaining very high classification accuracy for tissue types, even when the number of sample datasets was low. Although overfitting can be a common problem in applications of AI/ML, we did not see evidence of overfitting in our analyses. Both the GNN and ResNet18 performed with high accuracy with ResNet18 often performing better. We hypothesize that the additional noise in our mouse expression datasets, which were obtained from several disparate sources instead of initiatives such as the TCGA and GTEX, may have helped prevent overfitting (Fig. S1B; https://doi.org/10.5061/dryad.k3j9kd5kz). Although noise is generally considered detrimental to model performance, certain regularization techniques introduce controlled noise during training to enhance generalization and mitigate overfitting (Noh et al. 2017). Consequently, our analyses used the GNN model given its very close performance despite being simpler than ResNet18. The goal of this study was to identify putative novel mechanisms of chemical toxicity. Comparison of traditional PA and our GNN model showed very little agreement. This is not surprising as neural networks learn from hidden layers which can capture complex interactions. Although the 2 methods can be used to uncover mechanisms underlying chemical toxicity from transcriptomic data, they differ in their methodologies and interpretative capacities. Traditional PA relies on predefined databases, providing a transparent and interpretable framework for identifying disrupted pathways. Although this approach ensures reproducibility and clarity, it risks oversimplifying complex interactions and may overlook mechanisms not explicitly captured in existing databases. In contrast, neural networks utilize hidden layers to model complex interactions between genes and pathways, capturing latent representations of gene expression data that can reveal novel mechanisms previously inaccessible using traditional approaches. Although neural networks demonstrate robustness to noise and greater exploratory power, their “black-box” nature reduces interpretability and makes it challenging to directly trace predictions to specific genes or pathways. To address the interpretability challenges posed by neural networks, we use IG values to attribute model predictions to specific reactions and pathways. This approach allows us to uncover key pathways that may drive the observed toxicological mechanisms. Future work could further validate IG-based findings by correlating them with experimental or pathway enrichment data. Our GNN analysis, notably, did not identify reactions driven by aryl hydrocarbon receptor (AHR) battery genes such as Cyp1a1 and Cyp1a2, known targets of TCDD. Reactome is a database of endogenous reactions and while some chemical and drug metabolism reactions are represented, many, such as the transcription of Cyp1a1 by AHR: ARNT binding was not present in our mouse network. Nevertheless, several key reactions were identified as being disrupted. At a dose of 30 µg/kg, reactions represented the SUMOylation, P53 stabilization and phosphorylation, and cell cycle DNA damage checkpoint pathways. SUMOylation is reported to regulate the activity of the AHR and the AHR repressor, and TCDD can reduce SUMOylation of the AHR increasing its stability (Oshima et al. 2009; Xing et al. 2012). Similarly, TCDD has been experimentally shown to lead to cell cycle arrest (Jackson et al. 2014), and the AHR to regulate P53 protein levels (Moreno-Marín et al. 2018). Moreover, reactions identified as important with low connectivity, such as prolyl-4 hydroxylase and collagen biosynthesis, are consistent with histological findings in the studies from which these data were obtained (Nault et al. 2016; Fader et al. 2019). These findings suggest that using a more comprehensive metabolic network which incorporates adverse outcome pathways in future reaction-based GNN models could significantly improve classification of toxicants. In addition to the graph, performance of GNN models depends heavily on the quality of input data. One of the main challenges encountered during this study was collecting sufficient appropriate datasets for training and validating our GNN model. Although publicly deposited transcriptomic datasets have benefited from efforts like MIAME and MINSEQE to ensure public accessibility and standardization of metadata, challenges persist, particularly when applying ML approaches to nonhuman data. For environmental health science-focused studies, rodent data repositories such as DrugMatrix and TG-GATEs are available, but generally consist of a small number of samples (Ganter et al. 2006; Igarashi et al. 2015; Söllner et al. 2017), and were produced using microarrays rather than more modern next-generation sequencing. Consequently, we were unable to find enough samples from other toxicants or tissues to further investigate the generalizability of our model. Moreover, we cannot exclude the possibility that some of our datasets may represent sequencing reads from the same sample split across multiple sequencing lanes (Wilks et al. 2021), potentially introducing some bias. These challenges further highlight the need, and importance, of efforts to increase promote the Findable, Accessible, Interoperable, and Reusable data principles (Nault et al. 2023). Despite these challenges, our GNN model demonstrated strong performance even with limited data.\n\n## Conclusion\nTo date, most applications of AI in environmental health sciences, especially those involving GNNs, have emphasized predictive approaches such as chemical and risk characterization and pharmacokinetics from structural information (Zaslavskiy et al. 2019; Cai et al. 2022; Chou and Lin 2023; Mehta et al. 2023; Tan et al. 2023), as well as from transcriptomic data (Mohsen et al. 2021; Chen et al. 2022; Kana et al. 2023; Li et al. 2023b). We hypothesized that the application of a GNN based on the network of metabolic reactions and pathways we can gain new insights into the metabolic perturbations elicited by toxicants such as TCDD from transcriptomic data. We demonstrate that the use of a GNN can facilitate the identification of metabolic reaction networks perturbed by toxicant exposure. Unlike traditional PA, which is limited by predefined databases and thresholds, the GNN model captured complex, latent interactions between genes and pathways revealing changes in SUMOylation, P53 stabilization, and extracellular matrix remodeling by TCDD. Collectively, we show that deep learning approaches can be a useful resource for the discovery of toxicant-induced metabolic perturbations. Efforts to establish more comprehensive and standardized rodent transcriptomics datasets are likely to further enhance the ability to unravel these complex mechanisms.",
  "word_count": 8697,
  "char_count": 59998
}